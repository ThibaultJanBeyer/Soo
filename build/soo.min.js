"use strict";function cssToDom(e){const t=document.createElement("style");return t.textContent=e,t}const UUID=()=>{let e=()=>(65536*(1+Math.random())|0).toString(16).substring(1);return"p"+(e()+e())+"-"+e()};class Parser{constructor(e,...t){this.values_map=[],this.string=this.concat_string(e,t)}concat_string(e,t){return e.map((e,s)=>{const n=t[s],r=UUID();switch(!0){case"function"==typeof n:e=e.concat(`"${r} `),this.values_map.push({id:r,value:n});break;case"object"==typeof n||n&&1===n.nodeType:e=`${e} <template ${r}></template>`,this.values_map.push({id:r,value:n});break;case"string"==typeof n:e=`${e}${n||""}`}return e}).reduce((e,t)=>e+t)}get fragment(){const e=document.createElement("template");return e.innerHTML=this.string,this.place_values(e.content.cloneNode(!0))}get container(){let e=(new DOMParser).parseFromString(this.string,"text/html");return this.place_values(e.body.firstChild)}get svg(){let e=new DOMParser;const t=this.container;t.setAttribute("xmlns","http://www.w3.org/2000/svg");let s=e.parseFromString(t.outerHTML,"image/svg+xml");return this.place_values(s.documentElement)}place_values(e){return this.values_map.forEach(t=>{const s=e.outerHTML?e.parentNode.querySelector(`[${t.id}]`):e.querySelector(`[${t.id}]`);if(!s)throw new Error('Warning function must be defined between parentheses for example "${calledFunction}"');if("function"==typeof t.value){const e=/(on)\w+/g.exec(s.outerHTML)[0].split("on")[1];s.addEventListener(e,t.value.bind(this)),s.removeAttribute(`on${e}`)}else if("object"==typeof t.value)if(t.value.children)s.replaceWith(t.value);else{const e=document.createDocumentFragment();t.value.forEach(t=>e.appendChild(t)),s.replaceWith(e)}}),e}}function HTML(e,...t){return new Parser(e,...t)}window.HTML=HTML;class Soo extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"}),this.cssApplied=!1}connectedCallback(){this.css&&(this.shadowRoot.appendChild(cssToDom(this.css())),this.cssApplied=!0),this.install.apply(this),this.shadowRoot.appendChild(this.render().container),this.installed()}disconnectedCallback(){this.uninstall()}fire(e,t){this.dispatchEvent(new CustomEvent(e,{detail:t}))}updateDom(e){const t=this.cssApplied?1:0;this.shadowRoot.children[t].replaceWith(e)}update(){this.beforeUpdate(),this.beforeRender(),this.updateDom(this.render().container),this.afterUpdate()}install(){}installed(){}uninstall(){}beforeUpdate(){}afterUpdate(){}beforeRender(){}}window.Soo=Soo,module.exports=Soo;
